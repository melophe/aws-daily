# AWS Storage Gateway

## 概要

File Gateway は、オンプレミス環境から NFS や SMB プロトコル を使って Amazon S3 バケットを透過的にファイル共有ストレージとして利用できるサービス

**File Gateway の「メインの役割」はオンプレとAWS（S3）の橋渡し**

- File Gateway は オンプレに仮想アプライアンス（VMware/Hyper-V/KVM または EC2 AMI）をデプロイして利用
- オンプレ側からは NFS/SMBで普通のファイルサーバに見える
- 実際のデータは AWS S3に保存 され、クラウドの耐久性・拡張性を利用できる
- よく使うファイルはオンプレにキャッシュ → ユーザーは低レイテンシで利用できる

## 特徴

### オンプレのファイルサーバのように見える
- ユーザーやアプリは NFS/SMB でアクセス
- 実際のデータは S3 バケットに保存される

### キャッシュ機能
- 頻繁に利用されるデータはオンプレのゲートウェイにキャッシュされる
- よく使うファイルは低レイテンシでアクセス可能

### オブジェクトストレージの利点を活用
- 保存先は S3 なので、ライフサイクルポリシーを使って S3 Glacier / Glacier Deep Archive に自動移行可能
- コスト最適化がしやすい

### アクセス管理
- SMB の場合は Active Directory と統合できるので、ユーザーごとのアクセス制御が可能

File Gateway の典型ユースケース
1. オンプレNASの置き換え

社内ファイルサーバ（NAS）の代替として導入

ユーザーは SMB/NFS で今まで通りアクセス

実データは Amazon S3 に保存 → 拡張性・耐久性を享受

メリット: ハードウェア管理不要、容量制限ほぼ無限

2. バックアップ／アーカイブ

ファイルサーバやアプリケーションのバックアップ先として利用

データは S3 に保存され、ライフサイクルポリシーで S3 Glacier / Deep Archive に自動移行可能

メリット: 低コストで長期保存、災害対策にも有効

3. ハイブリッドクラウドのファイル共有

オンプレ環境とAWS間でファイルをやり取りする「ハイブリッド共有」

例：オンプレ拠点からファイルをアップロード → クラウド上の分析処理（Athena, EMR, SageMaker など）で利用

メリット: オンプレ・クラウド双方から同じデータを扱える

4. クラウド連携アプリケーション

オンプレアプリが「SMB/NFSしか話せない」場合でも、File Gateway経由でS3を利用可能

例：オンプレの製造業アプリがログや画像を出力 → File Gateway経由でS3に保存 → AWSでAI/ML分析

---

# Storage Gateway の3つのモード

1. **File Gateway**
2. **Volume Gateway**
3. **Tape Gateway**

---

# Amazon S3 File Gateway の詳細

## 配置・利用方法
- オンプレに仮想アプライアンスを配置して利用（VMware/Hyper-V/EC2 で動かせる）
- オンプレのアプリやデバイスに **NFS** または **SMB** プロトコルでファイル共有を提供

## データの流れ
- そのファイルは自動的に **Amazon S3** にアップロードされる
- クラウド上では **S3 オブジェクト**として扱える

## パフォーマンス
- **キャッシュ機能**があるので最近使ったデータはオンプレ側で高速アクセス可能

ャッシュ機能

よく使うデータはオンプレにキャッシュして高速アクセス

セキュリティ

SMBの場合は Active Directory 認証と統合できる

透過性

ユーザーやアプリは S3 を意識せず利用できる

NAS とは

NAS（Network Attached Storage） は、
ネットワークに直接接続して利用するファイルストレージ専用機器 のことです。

NFS や SMB といったファイル共有プロトコルを使ってアクセスする

ユーザーやアプリからは「ネットワーク上のファイルサーバ」として見える

複数ユーザーが同時にファイルにアクセスできる
