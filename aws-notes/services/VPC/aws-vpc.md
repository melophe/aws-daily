# AWS VPC

## VPC Flow Logs

### 概要

**正式名称**: VPC Flow Logs

**VPC 内で ENI（Elastic Network Interface）を通過する通信のメタデータを記録する仕組み**

つまり「**どのIPがどのポートにいつ通信したか**」が分かるログ

### ログに含まれる情報

#### 代表的なフィールド

- **version**（バージョン）
- **account-id**（AWSアカウント）
- **interface-id**（ENI ID）
- **srcaddr / dstaddr**（送信元 / 宛先 IP）
- **srcport / dstport**（送信元 / 宛先 ポート）
- **protocol**（TCP/UDP/ICMP など）
- **action**（ACCEPT / REJECT → セキュリティグループやNACLで許可されたか拒否されたか）
- **bytes, packets**（通信量）

> **Note**: 中身は「パケットキャプチャ」ではなく、**通信のサマリ情報（メタデータ）**

### 取得できる単位

フローログは以下の単位で有効化できる：

- **VPC 単位**
- **サブネット単位**
- **ENI 単位**

### 出力先

- **CloudWatch Logs** に送って検索・可視化
- **S3 バケット**に保存して後から Athena や SIEM で解析

## 主なユースケース

### セキュリティ監査
**不審なアクセスが無いか確認**

### トラブルシューティング
**通信ができないときに「NACLで拒否されてるのか？」「そもそもパケット来てないのか？」を確認**

### ネットワークモニタリング
**トラフィック量や利用傾向を可視化**

## まとめ

- **フローログ** = VPCのネットワーク通信の記録（メタデータ）
- **通信の中身は取れず**、送信元/宛先・ポート・プロトコル・許可/拒否 などが分かる
- **出力先**: CloudWatch Logs または S3
- **セキュリティやトラブルシュートに必須**