# CloudWatch エージェント

## 概要

EC2 インスタンスなどの中にインストールして使う**ログ & メトリクス収集ツール**

インスタンス内で動いている OS やアプリから情報を集めて CloudWatch に送るためのソフトウェア

## 主にできること

### OS レベルのメトリクス収集

- **CPU 使用率**（論理 CPU ごと）
- **メモリ使用量**
- **ディスク使用率、ディスク I/O**
- **ネットワーク I/O**

### ログ収集

`/var/log/messages`、`/var/log/nginx/access.log` など任意のログを CloudWatch Logs に送信できる

## 標準メトリクスとの違い

### 標準メトリクス（CloudWatch エージェント不要）

EC2 を立ち上げると、何も入れなくても標準メトリクスは CloudWatch に送られる

**例**: CPU 利用率、ネットワークの送受信、EBS IOPS など

### CloudWatch エージェントが必要なもの

ただし、以下はデフォルトでは取れない

| メトリクス | 説明 |
|------------|------|
| **メモリ使用率** | OS 内のメモリ消費量 |
| **ディスク使用率** | ルートパーティションの空き容量など |
| **OS ログファイル** | /var/log 配下のログファイル |

> **これらを CloudWatch に送るために CloudWatch エージェントが必要**

## インストール・設定

### インストール方法
- インスタンス内に `yum`/`apt` または **SSM 経由**でインストール

### 設定
- **設定ファイル（JSON）**で「どのメトリクス」「どのログ」を送るか指定

### 動作
- バックグラウンドで常駐して、CloudWatch にデータをプッシュ

## まとめ

| 項目 | 標準 EC2 | CloudWatch エージェント |
|------|----------|--------------------------|
| **対象** | 基本的なインスタンスメトリクス | OS 内部の細かいメトリクスやログ |
| **収集データ** | CPU、ネットワーク、EBS など | メモリ、ディスク使用率、ログファイル |
| **インストール** | 不要（自動） | 必要（手動インストール） |

- **デフォルトの EC2** → CloudWatch に最低限のメトリクスは送る
- **CloudWatch エージェント** → OS 内部の細かいメトリクスやログを追加で収集できる