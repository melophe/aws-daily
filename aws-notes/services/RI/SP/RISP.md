# AWS コスト最適化: RI vs Savings Plans

## リザーブドインスタンス（RI）

### 対象サービス
- **EC2 のみ**

### 約束内容
RI では以下の条件を厳密に指定：

- **インスタンスタイプ**（例：m5.large）
- **リージョン**（例：ap-northeast-1）
- **テナンシー**（デフォルト/専有）

> **例**: 「m5.large を東京リージョンで 3 年間使う」と約束

### 特徴
- **割引率**: 最大72%と高い割引率
- **柔軟性**: サイズフレキシビリティ機能で「一部」の柔軟性あり
- **位置づけ**: 古典的な割引モデルで、細かく条件が縛られる

## Savings Plans

### 対象サービス
- **EC2**（全ての Savings Plans）
- **Fargate**（Compute SP のみ）
- **Lambda**（Compute SP のみ）

### 約束内容
**「時間あたりの利用料金」をコミット**

#### 例
- 1ドル/時間を3年間支払うと約束
- その分の使用量に対して割引が適用

### 特徴
- **柔軟性**: Compute SP なら EC2 のインスタンスタイプやリージョンを変更しても割引適用
- **比較**: RI より柔軟性が高い

## Savings Plans の種類

### 1. Compute Savings Plans

#### 特徴
- **柔軟性**: 最も高い
- **対象サービス**: EC2, Fargate, Lambda
- **変更許容**: リージョンやインスタンスタイプを変更してもOK

### 2. EC2 Instance Savings Plans

#### 特徴
- **対象**: EC2 専用の割引
- **条件**: 指定した「インスタンスファミリー」「リージョン」内での使用

#### 柔軟性
- **✅ 変更可能**: サイズや OS の変更
- **❌ 変更不可**: インスタンスファミリーや他リージョンへの移行

#### 例
**東京リージョンの m5 ファミリーに 3年コミット**

- **✅ 適用**: m5.large → m5.xlarge への変更
- **❌ 非適用**: c5 ファミリーや他リージョンへの移行

## RI と EC2 Instance SP の違い

### 固定レベルの比較

| 項目 | RI | EC2 Instance SP |
|------|----|--------------------|
| **固定範囲** | インスタンスタイプまで固定（例：m5.large） | インスタンスファミリー単位で柔軟（例：m5 系列ならどのサイズでもOK） |
| **柔軟性** | 最も制限が厳しい | RIより少し柔軟、Compute SPよりは縛りがある |

> **位置づけ**: EC2 Instance SP は「RIより少し柔軟」「Compute SPよりは縛りがある」ちょうど中間的な選択肢

### 共通点

- **コミットメント期間**: 1年 or 3年のコミットメント
- **割引率**: 最大72%と大きな割引
- **基本思想**: EC2 を長期利用するならコスト削減になる

### 詳細比較表

| 項目 | リザーブドインスタンス（RI） | EC2 Instance Savings Plans |
|------|---------------------------|---------------------------|
| **対象** | EC2 のみ | EC2 のみ |
| **指定範囲** | インスタンスタイプ（例：m5.large） | インスタンスファミリー単位（例：m5 系列） |
| **サイズ変更** | 基本できない（サイズフレキシビリティ機能あり） | 自由に変更OK（m5.large ⇔ m5.xlarge） |
| **OS/テナンシー** | 指定したものに縛られる | OSやテナンシーを変えても割引適用 |
| **割引適用** | 「予約したインスタンス」に対して適用 | 「対象ファミリーの利用料金」に自動で適用 |
| **管理** | 予約したインスタンスと利用状況を合わせる必要あり | 自動適用なので管理がラク |
| **柔軟性** | 低い（きっちり縛る） | 中程度（Compute SPよりは制約ある） |

## 結論

### モデルの違い

- **RI**: 「インスタンスを予約して縛る」モデル
- **EC2 Instance SP**: 「インスタンスファミリー単位で柔軟に使える」モデル

> **位置づけ**: EC2 Instance SP は実質「RI の進化版」と考えて良い

🔹 1. リザーブドインスタンス (RI)

歴史が古い割引モデル（EC2専用）

「特定のインスタンスタイプを 1年 or 3年使い続ける」と約束

最大 72% 割引

ただし縛りが強い（インスタンスタイプ・リージョン・テナンシー固定）

例: ap-northeast-1 の m5.large を 3年間使う

🔹 2. Savings Plans

RI の進化版、より柔軟なコミット制割引

2種類ある：

Compute Savings Plans

EC2 / Fargate / Lambda に割引適用

リージョンやインスタンスタイプを変えてもOK

柔軟性が高いが割引率はやや低め

EC2 Instance Savings Plans

EC2 専用（RI よりは柔軟）

ファミリー＋リージョン単位で割引（例: 東京リージョンの m5 系）

割引率は高め

🔹 3. スポットインスタンス

余剰キャパシティを安く借りる仕組み

最大 90% 割引

ただし「いつ終了されるかわからない」

バッチ処理や中断に強いワークロード向け

🔹 スポットインスタンスと Fargate の関係

EC2 Spot インスタンス

AWS の余剰キャパシティを格安で利用できる

最大 90% オフ

いつ中断されてもおかしくない（2分前通知あり）

👉 EC2 ベースの Batch や ECS/EKS なら使える

Fargate

サーバーレスでコンテナを実行

スポット相当の仕組みはない

なので「Fargate Spot」みたいなものは存在しない

👉 結論：Spot は EC2 専用、Fargate では使えない