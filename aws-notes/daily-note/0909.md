# マルチキャスト

## 概要
ネットワークでのデータ配信方式のひとつで、「1台の送信者が、複数の特定の受信者に同時にデータを送る」通信方法

## 通信方式の種類

### ユニキャスト（Unicast）
1対1 の通信（例: Webブラウザからサーバーへのリクエスト）

### ブロードキャスト（Broadcast）
ネットワーク内の全員に送信（例: ARPリクエスト）

### マルチキャスト（Multicast）
グループに参加しているホストだけが受け取る

---

## VPCピアリング
VPCピアリングを通じて2つのVPCを接続することができる

## VPC拡張ルーティング
- Redshiftクラスターに対するVPC経由のトラフィック設定を調整する機能
- VPCからのトラフィックをルーティングし、VPCフローログを用いてRedshiftクラスター上のCOPYおよびUNLOADトラフィックを監視することが可能

---

# カスタマーゲートウェイ (Customer Gateway, CGW)

## 概要
- オンプレミス側のネットワーク機器やVPNソフトウェア をAWSに登録したリソース
- AWSとのSite-to-Site VPNを張るときに必須

## 役割
- オンプレ側で VPNトンネルの終端 になる
- AWSの Virtual Private Gateway (VGW) または Transit Gateway (TGW) と対向して、暗号化通信（IPSec）を確立
- オンプレLANとAWS VPC内リソース（RDSやEC2など）の 安全な通信経路 を作る

**Site-to-Site VPN を張るときには CGW（Customer Gateway）が必須**

CGW が必要になるケース

AWS Site-to-Site VPN

これは必須。

オンプレ側のVPN終端（ルータ/ファイアウォール/Linux VPNサーバ）をCGWとしてAWSに登録する。

AWS Transit Gateway + VPN接続

Transit Gatewayを使うときも、オンプレとVPNでつなぐならCGWが必要。

（TGWのVPNアタッチメントの相手としてCGWが出てくる）

CGW が不要なケース

AWS Direct Connect

物理専用線で接続するのでCGWは不要。

代わりに「DX Gateway」や「VGW/TGW」と接続する。

Client VPN

各ユーザー端末（PC）が直接AWSのClient VPNエンドポイントに接続する。

ここではオンプレのVPNルータは不要なのでCGWは関係ない。

VPC Peering

VPC間の通信だけなのでオンプレを介さない → CGW不要。

AWS PrivateLink / VPCエンドポイント

AWSサービスや他のVPCとプライベート接続する仕組み → CGW不要。

CGW必須 → オンプレとAWSを Site-to-Site VPN / TGW VPN でつなぐ場合

不要 → Direct Connect、Client VPN、VPC Peering、PrivateLink など

---

## SMB (Server Message Block)
Windows系ファイル共有プロトコル

---

## 大容量データ移行の考慮事項

### データ量
100TB超

### 課題
大容量 → ネットワーク転送だけでは非現実的になる可能性

### データ特性
- ほとんど非構造化データ
- ファイルベースのストレージが必要（オブジェクトストレージへの直接移行はアプリ変更が必要になる可能性）

---

# フェールオーバールーティング (Route 53 Failover Routing)

## 概要
Route 53 のルーティングポリシーの1つ

## 動作
プライマリとセカンダリのリソースを設定しておき、プライマリがヘルスチェックに失敗したらセカンダリに切り替える

## 使用するヘルスチェック
Route 53 のヘルスチェック機能（ALBが自分で持っているヘルスチェックではない）

**「ALBのヘルスチェック」ではなく、Route 53 独自のヘルスチェックを使って判定**

---

# ALB のヘルスチェック

## 概要
ALB がターゲットグループ内のEC2やECSタスクに対して行うヘルスチェック

## 目的
トラフィックを「生きているターゲット」にのみ振り分ける

## 注意点
ALB が不健康になったら、そのALBのDNS名自体は生きているが、ターゲットが無い状態になることもある

---

# まとめ

**フェールオーバールーティング** → Route 53 のヘルスチェックを利用

**ALBのヘルスチェック** → 別物（目的も範囲も違う）

## API GatewayとS3統合

**Amazon S3とAmazon API Gatewayを統合する設定は不可能**

---

# リアルタイム処理: Lambda vs Kinesis

## 概要
「リアルタイム処理」と問題文に書かれたら、**Lambda だけでは弱いケースが多く、Kinesis（またはMSK/Kafka） が本命として登場しやすい**

## Lambda と Kinesis の役割の違い

### AWS Lambda
- イベント駆動の処理（トリガーが来たら実行）
- 短時間・軽量な処理に最適（数秒以内の処理、シンプルな関数実行）
- バッチ処理や少量データのリアルタイム変換には向く
- 高トラフィックが続くとコンカレンシー制御が必要になり、スループットに限界あり

### Amazon Kinesis
- ストリーミングデータ基盤（常時流れ続ける膨大なデータに対応）
- 高スループット（数MB/秒〜GB/秒までスケーラブル）
- サブスクライバーを複数立てて並列処理可能（分析・保存などを同時に実行）
- Kinesis Data Analytics を使えば SQLライクにリアルタイム処理できる
- Lambda も Kinesis のコンシューマーとして連携できる

## 「リアルタイム」と言われたら？

### ケース別選択指針
- **試験問題や設計要件で 「リアルタイムにストリーミングデータを処理」** → **Kinesis / MSK**
- **「特定イベントが起きた時に即時処理」** → **Lambda**
- **「高トラフィック」「リアルタイム処理」** → **Kinesisが軸**

### まとめ
- **リアルタイム × 大量データ × ストリーミング** → **Kinesis が本命**
- **イベント駆動 × 軽量処理** → **Lambda が本命**

---


# API Gateway と Kinesis 統合

## 誤解と事実
**「API GatewayとKinesisは直接統合できない」と一般的には言うけど、正確には「Lambdaを挟まなくてもサービス統合で直結可能」**

## 注意点
IAM認証の設定や一時クレデンシャルの発行が必要