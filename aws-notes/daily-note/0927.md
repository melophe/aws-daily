# Lambda Function URL と権限

## Lambda Function URL

### 従来
- Lambda は単体では HTTP エンドポイントを持たない
- 呼ぶには API Gateway / ALB 経由が必須だった

### 現在
- Function URL を有効化すれば、Lambda に直接 HTTPS エンドポイントが割り当てられる
- その URL をブラウザや curl で叩くと Lambda が実行される
- 追加料金なし（Lambda 実行分だけ）

---

## Lambda の権限システム

### 1. 実行ロール（Execution Role）

Lambda 自身が外部リソースにアクセスするための権限

- IAM ロールで Lambda にアタッチするもの
- 例: Lambda が S3 を読む → 実行ロールに `s3:GetObject` を付与する

### 2. リソースベースポリシー（Resource-based Policy）

Lambda が「呼ばれる側」として、誰に呼ばれるかを制御する権限

- Lambda 関数に直接アタッチされるポリシー
- ここで出てくるのが `lambda:InvokeFunction`

#### 実装例
EventBridge, S3, API Gateway が Lambda を呼ぶ → Lambda 側のリソースポリシーに設定

```json
{
  "Effect": "Allow",
  "Principal": { "Service": "events.amazonaws.com" },
  "Action": "lambda:InvokeFunction",
  "Resource": "arn:aws:lambda:ap-northeast-1:123456789012:function:MyFunction"
}
```
