# AWS 学習メモ

## SFTP とデータ転送

- SFTP = SSH を使った安全なファイル転送プロトコル
- DataSync = NFS/SMB/HDFS/S3/EFS/FSx 専用（SFTPは対象外）
- SFTPを扱うなら AWS Transfer Family を使うのがベスト

---

## データベース移行

- AWS DMS = データベース移行サービス
- スキーマ変換には AWS SCT を併用

---

## CloudFormation

### 変更管理
変更セットは事前に確認すること

### 参照方法
- 同じスタック内: Ref, Fn::GetAtt
- 別スタック間: Export / ImportValue

---

## AWS Organizations

AWS Organizations を作成した直後は、「FullAWSAccess」 という SCP が全 OU とアカウントにアタッチされている

- FullAWSAccess = すべてのサービス／アクションを許可
- SCP は「この範囲までしか許可できない」という上限

---

## ネットワーク・セキュリティ

### ポート番号
1433番: Microsoft SQL Server (MSSQL) がデフォルトで使う TCP ポート番号

### エフェメラルポート
クライアントがサーバーに通信するときに 一時的に自動割り当てされるポート番号

---

## CloudFront

cloudfrontには価格クラスがあり高いほど速くなる

---

## AWS ParallelCluster

スーパーコンピュータ環境をAWS上で作るためのサービス

---

## DynamoDB トランザクション

### 基本機能
- 複数操作をまとめて1つのトランザクションに
- 最大 25 個の操作をまとめられる
- 複数テーブルにまたがってもOK
- ACID 特性

### 実用例
DynamoDBテーブルに対して複数の項目の追加、更新、または削除を一つのオペレーションとして管理できるワークフローを作れる

例：
- 「新しいアイテムを追加する (Put)」
- 「もし機密フラグが立っていたら削除する (ConditionCheck + Delete)」

これらを1つのトランザクションにまとめることで、中途半端な状態が残らない

---

## SQS 優先度制御

複数キューを作って、それを優先度付きのように扱う

### 構成例
- 有料ユーザー用 → HighPriorityQueue
- 無料ユーザー用 → StandardQueue

### 処理ロジック
1. HighPriorityQueue を優先的にポーリングする
2. 空なら StandardQueue を処理する

---

## S3データ転送の高速化

Amazon S3 Transfer Acceleration

---

## ACM 証明書

ACM を利用する場合、EC2にインストールするのではなくELBにインストール

---

## NACL の挙動

### デフォルトNACL
- Inbound / Outbound ともに すべて許可 (Allow All)
- だから特に何もしなくても通信できる

### カスタムNACL
- Inbound / Outbound のルールを自分で書く必要がある
- ステートレスなので 行きと戻りを両方許可しないと通信不可
- つまり「Inboundだけ許可してもNG」

### SSHの場合
- Inbound: ポート22を許可
- Outbound: クライアントのエフェメラルポート(1024–65535)を許可

両方そろって初めてSSHがつながる

**ステートレス！**

---

## Redshift

### WorkLoad Management
Redshift でクエリを効率的に処理するための クエリキュー管理システム

クエリを「キュー」に入れて、リソース（メモリ・並列実行枠）を配分

---

## その他

### DMS vs SCT
- DMS = データ移行
- SCT = スキーマ変換

### PrivateLink 接続条件
「サードパーティのアプリが AWS 上にある」＋「プライベートに接続したい」＋「インターネット接続は最小限」 という条件

---

## IOPS について

### 定義
IOPS = Input/Output Operations Per Second

1秒あたりの入出力処理回数

### 補足
- 「IO」= 入出力を意味する
- 「io1 / io2」= 高IOPSを提供するSSD